@{
    ViewBag.Title = "Chat1";
    //Layout = "~/Views/Shared/_Layoutmain.cshtml";
    Layout = null;
    
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
   <script src="~/Scripts/jquery-1.7.1.min.js"></script>
    <script src="~/Scripts/jquery-1.9.1.min.js"></script>
    <script src="~/Scripts/jquery.signalR-1.0.0-alpha1.min.js"></script>
    <script src="~/SignalR/Hubs"></script>
    <script>
        var $j = $.noConflict(true);
    </script>
    <!-- Latest compiled and minified CSS -->
   @* <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>*@
    
   


    <!-- The one Above does not exist, this will be generated by itself after the project is ready !-->
    <script type="text/javascript">
        $j(function () {
            //Create Hub on Air

            debugger;
            var chat = $j.connection.chatHub;

            //Messages
            $jmessages = $j("#messages");

            //Client Side Method To Access From Server Side Method
            chat.client.addMessage = function (frm, msg) {

                var a = frm;
                var b = msg;
                $j.getJSON("/Chatting/save",
                {
                    a: a,
                    b: b

                }, function (data) {
                    if (data != null) {
                        $j(messages).append("<b>" + frm + ":</b>" + msg+"<br/>");
                    }
                })
                
            };
            $j('#name').val('@Session["username"]' );
            $j("#txtMsg").keypress(function (e) {
                //when enter
                if (e.which == 13) {

                    //get value of input
                    var input = $j(this).val();

                    //send message to "Server Side Method"
                    chat.server.sendMessage($j('#name').val(), input);

                    //Reset TextBox
                    $j(this).val("");
                }

            });
            //Hub Starting
            $j.connection.hub.start();
        });
    </script>
   
</head>
<body>

    <input type="hidden" id="name" />
    <div id="messages">
        <table>
            @foreach (var x in Model)
            {
                <tr>
                    <td>@x.From : @x.msg</td>

                </tr>
            }
        </table>
    </div>
    <input type="text" id="txtMsg" style="max-width:100%; width: 100%;color:black;height:40px;" />

</body>
</html>


